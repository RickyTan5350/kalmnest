# Migrations
- Version control for database
- Write PHP code to describe database structure instead of manually creating tables
```
php artisan make:migration <table-name>
```
## Table Design
```
public function up(): void
{
    Schema::create('chirps', function (Blueprint $table) {
        $table->id();
        $table->foreignId('user_id')->nullable()->constrained()->cascadeOnDelete();
        $table->string('message', 255);
        $table->timestamps();
    });
}
```

Breakdown
- `id()` - Creates an auto-incrementing ID (primary key)
    
- `foreignId('user_id')` - Links each chirp to a user
    
- `nullable()` - Makes the user_id optional for now (we'll fix this when we add authentication)
    
- `constrained()` - Creates a foreign key constraint
    
- `cascadeOnDelete()` - If a user is deleted, delete their chirps too
    
- `string('message', 255)` - The chirp text (max 255 characters)
    
- `timestamps()` - Adds created_at and updated_at columns automatically
# Run Migration
```
php artisan migrate
```
# Laravel Tinker
```
php artisan tinker
```

- Provides view of databases
- To show table chirps(raw SQL query)
```
\DB::select('SELECT * FROM chirps');
```

- Can be used to insert data
```
\DB::table('chirps')->insert(
	[
		'user_id' => something,
		'message' => 'text',...
	]
);
```

- Checking the tables(Laravel Query Builder using Object-Oriented way)
```
\DB::table('chirps')->get();
```

## Exit Tinker
```
exit
```
# Migration Rollbacks
```
php artisan migrate:rollback
```
- Runs down() method to drop tables
- Modify migration and run `php artisan migrate`  again
- Will delete any data in tables
# Tips
- Migration files are timestamped to run in correct order
- Do not edit old migrations, **create new ones to modify existing tables**
- Keep migrations in version control
- Use `php artisan migrate:fresh` to drop all tables and re-run migrations
